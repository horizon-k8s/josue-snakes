<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Horizon Snake: Pro Edition</title>
    <style>
        body {
            margin: 0; padding: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            height: 100vh; background-color: #578a34;
            font-family: 'Arial', sans-serif;
            overflow: hidden; touch-action: none;
        }
        #game-wrapper {
            position: relative;
            background-color: #4a752c;
            padding: 15px; border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        #score-board {
            display: flex; align-items: center;
            justify-content: space-between;
            width: 100%; max-width: 340px;
            margin-bottom: 10px; color: white;
            font-weight: bold; font-size: 20px;
        }
        #game-container {
            position: relative; width: 340px; height: 340px;
            background-color: #aad751; border-radius: 5px;
            overflow: hidden;
        }
        canvas { display: block; }
        .overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: rgba(0,0,0,0.6); z-index: 10;
            text-align: center; color: white;
        }
        button {
            background: #4a752c; border: none;
            color: white; padding: 12px 30px;
            font-size: 18px; font-weight: bold;
            border-radius: 50px; cursor: pointer;
            margin-top: 20px; box-shadow: 0 4px #2c451a;
        }
        button:active { transform: translateY(2px); box-shadow: 0 2px #2c451a; }
    </style>
</head>
<body>
    <div id="score-board">
        <span>üçé <span id="score">0</span></span>
        <span>üèÜ <span id="high-score">0</span></span>
    </div>

    <div id="game-wrapper">
        <div id="game-container">
            <canvas id="gameCanvas"></canvas>
            <div id="game-over" class="overlay" style="display: none;">
                <h1 style="font-size: 36px; margin: 0;">¬°GAME OVER!</h1>
                <p id="final-msg"></p>
                <button onclick="resetGame()">REINTENTAR</button>
            </div>
            <div id="start-screen" class="overlay">
                <h1 style="font-size: 32px;">SNAKE GOOGLE STYLE</h1>
                <p>Desliza para mover a la serpiente</p>
                <button onclick="startGame()">¬°A JUGAR!</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const highEl = document.getElementById('high-score');
        const gameOverScreen = document.getElementById('game-over');
        const startScreen = document.getElementById('start-screen');

        canvas.width = 340; canvas.height = 340;
        const gridSize = 20;
        const tileCount = canvas.width / gridSize;

        let score = 0, highScore = 0;
        let snake = [], food = {x: 5, y: 5};
        let dx = 1, dy = 0, nextDx = 1, nextDy = 0;
        let gameLoop, isPaused = true;

        function startGame() { startScreen.style.display = 'none'; isPaused = false; resetGame(); }
        
        function resetGame() {
            score = 0; scoreEl.innerHTML = score;
            snake = [{x: 8, y: 10}, {x: 7, y: 10}, {x: 6, y: 10}];
            dx = 1; dy = 0; nextDx = 1; nextDy = 0;
            gameOverScreen.style.display = 'none';
            placeFood();
            if(gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(draw, 150);
        }

        function placeFood() {
            food = {x: Math.floor(Math.random() * tileCount), y: Math.floor(Math.random() * tileCount)};
            if (snake.some(s => s.x === food.x && s.y === food.y)) placeFood();
        }

        function draw() {
            if(isPaused) return;
            dx = nextDx; dy = nextDy;
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};

            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount || 
                snake.some(s => s.x === head.x && s.y === head.y)) return gameOver();

            snake.unshift(head);
            if (head.x === food.x && head.y === food.y) {
                score++; scoreEl.innerHTML = score; placeFood();
            } else { snake.pop(); }

            // Fondo de cuadros (checkerboard)
            for(let y=0; y<tileCount; y++) {
                for(let x=0; x<tileCount; x++) {
                    ctx.fillStyle = (x + y) % 2 === 0 ? '#aad751' : '#a2d149';
                    ctx.fillRect(x * gridSize, y * gridSize, gridSize, gridSize);
                }
            }

            // Manzana (Dibujo)
            const fx = food.x * gridSize, fy = food.y * gridSize;
            ctx.fillStyle = '#e91e23'; // Rojo manzana
            ctx.beginPath();
            ctx.arc(fx + 10, fy + 11, 8, 0, Math.PI*2);
            ctx.fill();
            ctx.fillStyle = '#578a34'; // Hoja
            ctx.fillRect(fx + 9, fy + 2, 3, 5);

            // Serpiente (Dibujo suave)
            snake.forEach((s, i) => {
                ctx.fillStyle = '#4671ea'; // Azul Google
                const r = i === 0 ? 10 : 9;
                ctx.beginPath();
                ctx.arc(s.x * gridSize + 10, s.y * gridSize + 10, r, 0, Math.PI*2);
                ctx.fill();

                // Conexiones entre segmentos
                if (i > 0) {
                    const prev = snake[i-1];
                    ctx.fillRect(
                        Math.min(s.x, prev.x) * gridSize + (s.x === prev.x ? 1 : 0),
                        Math.min(s.y, prev.y) * gridSize + (s.y === prev.y ? 1 : 0),
                        s.x === prev.x ? 18 : gridSize,
                        s.y === prev.y ? 18 : gridSize
                    );
                }

                if (i === 0) { // Ojos y cara
                    ctx.fillStyle = 'white';
                    ctx.beginPath();
                    ctx.arc(s.x * gridSize + 6, s.y * gridSize + 8, 4, 0, Math.PI*2);
                    ctx.arc(s.x * gridSize + 14, s.y * gridSize + 8, 4, 0, Math.PI*2);
                    ctx.fill();
                    ctx.fillStyle = 'black';
                    ctx.beginPath(); // Pupilas seg√∫n direcci√≥n
                    const px = dx * 2, py = dy * 2;
                    ctx.arc(s.x * gridSize + 6 + px, s.y * gridSize + 8 + py, 1.5, 0, Math.PI*2);
                    ctx.arc(s.x * gridSize + 14 + px, s.y * gridSize + 8 + py, 1.5, 0, Math.PI*2);
                    ctx.fill();
                }
            });
        }

        function gameOver() {
            clearInterval(gameLoop);
            if(score > highScore) { highScore = score; highEl.innerHTML = highScore; }
            gameOverScreen.style.display = 'flex';
        }

        // Swipe Controls
        let tsX, tsY;
        document.addEventListener('touchstart', e => { tsX = e.touches[0].clientX; tsY = e.touches[0].clientY; }, false);
        document.addEventListener('touchmove', e => {
            if (isPaused) return; e.preventDefault();
            let teX = e.touches[0].clientX, teY = e.touches[0].clientY;
            let dX = teX - tsX, dY = teY - tsY;
            if (Math.abs(dX) > Math.abs(dY)) {
                if (dX > 30 && dx === 0) { nextDx = 1; nextDy = 0; }
                else if (dX < -30 && dx === 0) { nextDx = -1; nextDy = 0; }
            } else {
                if (dY > 30 && dy === 0) { nextDx = 0; nextDy = 1; }
                else if (dY < -30 && dy === 0) { nextDx = 0; nextDy = -1; }
            }
        }, {passive: false});
    </script>
</body>
</html>
